!function(e){function t(t){for(var r,n,i=t[0],a=t[1],c=t[2],h=0,d=[];h<i.length;h++)n=i[h],l[n]&&d.push(l[n][0]),l[n]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);for(u&&u(t);d.length;)d.shift()();return s.push.apply(s,c||[]),o()}function o(){for(var e,t=0;t<s.length;t++){for(var o=s[t],r=!0,i=1;i<o.length;i++){var a=o[i];0!==l[a]&&(r=!1)}r&&(s.splice(t--,1),e=n(n.s=o[0]))}return e}var r={},l={0:0},s=[];function n(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=r,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var i=window.webpackJsonp=window.webpackJsonp||[],a=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=a;s.push([501,1]),o()}({1384:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=o(239),l=["blue","green","orange","red","white","yellow"],s=65,n=8,i=8*s,a=180,c=180;t.default=class extends r.Scene{preload(){l.forEach(e=>this.load.image(e,`assets/${e}.png`))}create(){this.createBackground(),this.initBoard(),this.input.on("pointerdown",this.onPointerDown,this)}createBackground(){this.add.grid(i/2,i/2,i,i,s,s).setFillStyle(2436664).setAltFillStyle(2173235).setOutlineStyle()}initBoard(){this.board=function(e){const t=new Array(e);for(let o=0;o<e;o++){t[o]=new Array(e);for(let r=0;r<e;r++)t[o][r]={row:o,column:r,color:null,sprite:null,empty:!0}}return t}(n);for(let e=0;e<n;e++)for(let t=0;t<n;t++){const o=this.board[e][t],n=[];for(let e of l)o.color=e,this.shouldExplode(o)||n.push(e);o.color=r.Math.RND.pick(n),o.empty=!1;const i=t*s+s/2,a=e*s+s/2;o.sprite=this.add.sprite(i,a,o.color).setInteractive()}}async onPointerDown(e){if(this.moveInProgress)return;const t=this.getCellAt(e);if(null==this.selectedCell)return void this.selectCell(t);const o=this.selectedCell,r=t;if(this.deselectCell(),o!==r)if(this.cellsAreNeighbours(o,r)){if(this.moveInProgress=!0,this.swapCells(o,r),await this.moveSpritesWhereTheyBelong(),this.boardShouldExplode())for(;this.boardShouldExplode();)await this.destroyCells(),await this.makeCellsFall(),await this.refillBoard();else this.swapCells(o,r),await this.moveSpritesWhereTheyBelong();this.moveInProgress=!1}else this.selectCell(r)}async makeCellsFall(){for(let e=0;e<n;e++)for(let t=n-1;t>=0;t--){const o=this.board[t][e],r=this.getLowestEmptyCellBelow(o);null===r||o.empty||this.swapCells(o,r)}await this.moveSpritesWhereTheyBelong()}async refillBoard(){for(let e=0;e<n;e++){let t=0;for(;t<n&&this.board[t][e].empty;)t++;for(let o=0;o<t;o++){const n=this.board[o][e];n.color=r.Math.RND.pick(l),n.empty=!1;const i=e*s+s/2,a=(o-t)*s+s/2;n.sprite=this.add.sprite(i,a,n.color).setInteractive()}}await this.moveSpritesWhereTheyBelong()}async moveSpritesWhereTheyBelong(){const e=this.board.flat(),t=[];for(const o of e){const e=o.sprite,r=o.column*s+s/2,l=o.row*s+s/2;if(e.x!==r||e.y!==l){const o=new Promise(t=>{this.tweens.add({targets:e,x:r,y:l,duration:a,onComplete:()=>t()})});t.push(o)}}await Promise.all(t)}getLowestEmptyCellBelow(e){for(let t=n-1;t>e.row;t--){const o=this.board[t][e.column];if(o.empty)return o}return null}async destroyCells(){const e=this.getCellsToDestroy();await Promise.all(e.map(e=>this.destroyCell(e)))}destroyCell(e){return new Promise(t=>{e.empty=!0,this.tweens.add({targets:e.sprite,alpha:0,duration:c,onComplete:()=>t()})})}getCellsToDestroy(){return this.board.flat().filter(e=>this.shouldExplode(e))}selectCell(e){this.selectedCell=e,this.selectedCell.sprite.setScale(1.2)}deselectCell(){this.selectedCell.sprite.setScale(1),this.selectedCell=null}swapCells(e,t){const o=Object.assign({},e);e.row=t.row,e.column=t.column,t.row=o.row,t.column=o.column,this.board[e.row][e.column]=e,this.board[t.row][t.column]=t}boardShouldExplode(){return this.board.some(e=>e.some(e=>this.shouldExplode(e)))}shouldExplode(e){return this.shouldExplodeHorizontally(e)||this.shouldExplodeVertically(e)}shouldExplodeHorizontally({row:e,column:t}){for(let o=t-3+1;o<=t;o++){const t=o+3-1;if(o>=0&&t<n){let r=!0;for(let l=o;l<t;l++)if(this.board[e][l].color!==this.board[e][l+1].color){r=!1;break}if(r)return!0}}return!1}shouldExplodeVertically({row:e,column:t}){for(let o=e-3+1;o<=e;o++){const e=o+3-1;if(o>=0&&e<n){let r=!0;for(let l=o;l<e;l++)if(this.board[l][t].color!==this.board[l+1][t].color){r=!1;break}if(r)return!0}}return!1}getCellAt(e){const t=Math.floor(e.y/s),o=Math.floor(e.x/s);return this.board[t][o]}cellsAreNeighbours(e,t){return e.row===t.row&&(e.column===t.column+1||e.column===t.column-1)||e.column===t.column&&(e.row===t.row+1||e.row===t.row-1)}}},501:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=o(239),l={title:"Bejeweled",width:520,height:520,scene:o(1384).default,disableContextMenu:!0},s=new r.Game(l);window.game=s}});